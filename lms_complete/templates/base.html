<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EduFlow - Modern Learning Platform{% endblock %}</title>
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts - Inter + Plus Jakarta Sans for modern look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300..800&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom tailwind config / palette extension -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#e6f0fa',
                            100: '#cce1f5',
                            200: '#99c3eb',
                            300: '#66a5e1',
                            400: '#3387d7',
                            500: '#1e6fc9', // main matte blue
                            600: '#1859a1',
                            700: '#124379',
                            800: '#0c2d50',
                            900: '#061628',
                        },
                        accent: {
                            50: '#e8f4f8',
                            100: '#d1e9f1',
                            200: '#a3d3e3',
                            300: '#75bdd5',
                            400: '#47a7c7',
                            500: '#2d8eb0', // complementary matte teal-blue
                            600: '#24728d',
                            700: '#1b556a',
                            800: '#123947',
                            900: '#091c24',
                        },
                        neutral: {
                          150: '#f0f2f5',
                          250: '#e2e5ea',
                          350: '#cbd0d8',
                          450: '#9ca3b5',
                          550: '#6b7285',
                          650: '#4b5568',
                          750: '#374151',
                          850: '#1f2937',
                          950: '#111827',
                        }
                    },
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'Inter', 'system-ui', 'sans-serif'],
                        display: ['Plus Jakarta Sans', 'sans-serif'],
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.5s ease-out forwards',
                        'float': 'float 8s ease-in-out infinite',
                        'float-slow': 'float-slow 12s ease-in-out infinite',
                        'pulse-subtle': 'pulseSubtle 3s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(12px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        float: {
                            '0%,100%': { transform: 'translate(0,0) scale(1)' },
                            '33%': { transform: 'translate(5%,5%) scale(1.02)' },
                            '66%': { transform: 'translate(-5%,-5%) scale(0.98)' },
                        },
                        'float-slow': {
                            '0%,100%': { transform: 'translate(0,0) scale(1)' },
                            '50%': { transform: 'translate(4%,4%) scale(1.04)' },
                        },
                        pulseSubtle: {
                            '0%,100%': { opacity: '0.4' },
                            '50%': { opacity: '0.7' },
                        },
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                    }
                }
            }
        }
    </script>
    
    <!-- Custom CSS for animations that need extra precision (only additive) -->
    <style>
        body { font-family: 'Plus Jakarta Sans', 'Inter', sans-serif; }
        /* custom glass morphism */
        .glass-panel {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }
        .glass-panel-dark {
            background: rgba(31, 41, 55, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        /* shine animation removed - no gradients */
        
        /* preserve animations from base if any */
        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100%); }
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body class="bg-[#f0f5fa] text-neutral-850 antialiased min-h-screen relative overflow-x-hidden">

    <!-- Background decoration: floating orbs with matte blue palette -->
    <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
        <div class="absolute -top-1/2 -right-1/4 w-[70%] h-[70%] bg-[#e6f0fa] rounded-full animate-float"></div>
        <div class="absolute -bottom-1/3 -left-1/4 w-[60%] h-[60%] bg-[#d1e9f1] rounded-full animate-float-slow" style="animation-delay: 1s;"></div>
        <div class="absolute top-1/3 left-1/4 w-96 h-96 bg-[#cce1f5] rounded-full blur-3xl animate-pulse-subtle"></div>
        <div class="absolute bottom-1/4 right-1/3 w-80 h-80 bg-[#e8f4f8] rounded-full blur-3xl animate-pulse-subtle" style="animation-delay: 1.5s;"></div>
    </div>

    <!-- Navigation - sticky with glass effect -->
    <nav class="sticky top-0 z-50 glass-panel border-b border-white/30 py-2">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <!-- Logo - Matte blue design (no gradients) -->
            <a href="/" class="flex items-center gap-2 group">
                <!-- Logo icon with matte effect -->
                <div class="relative w-11 h-11 flex items-center justify-center">
                    <!-- Matte background glow -->
                    <div class="absolute inset-0 bg-[#1e6fc9] rounded-xl opacity-40 blur-[6px] group-hover:opacity-60 group-hover:blur-[8px] transition-all duration-300"></div>
                    
                    <!-- Main icon container with matte blue -->
                    <div class="relative w-full h-full bg-[#1e6fc9] rounded-xl flex items-center justify-center text-white shadow-xl group-hover:shadow-2xl group-hover:scale-110 transition-all duration-300">
                        
                        <!-- Book icon with subtle animation -->
                        <div class="relative z-10 transform group-hover:rotate-3 transition-transform duration-300">
                            <i class="fas fa-graduation-cap text-2xl drop-shadow-md"></i>
                        </div>
                        
                        <!-- Decorative elements - matte -->
                        <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-white/30 rounded-full"></div>
                        <div class="absolute -top-1 -left-1 w-2 h-2 bg-white/40 rounded-full"></div>
                    </div>
                </div>
                
                <!-- Brand text with matte colors (no gradients) -->
                <div class="flex flex-col leading-tight">
                    <span class="text-2xl font-extrabold tracking-tight text-[#1e6fc9] group-hover:text-[#1859a1] transition-colors duration-300">
                        EduFlow
                    </span>
                    <span class="text-[0.65rem] font-medium text-[#99c3eb] tracking-wider uppercase -mt-1">Learn without limits</span>
                </div>
                
                <!-- Animated dot indicator - matte -->
                <span class="relative flex h-3 w-3 ml-1">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-[#2d8eb0] opacity-50"></span>
                    <span class="relative inline-flex rounded-full h-3 w-3 bg-[#1e6fc9]"></span>
                </span>
            </a>
            
            <!-- Nav links (hidden on mobile) with matte colors -->
            <div class="hidden md:flex items-center gap-6">
                <a href="{% url 'courses:course_list' %}" class="text-neutral-650 hover:text-[#1e6fc9] font-semibold text-sm transition-all relative group flex items-center">
                    <i class="fas fa-compass mr-1.5 text-[#99c3eb] group-hover:text-[#1e6fc9] transition-colors"></i>
                    <span class="relative">
                        Explore
                        <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-[#1e6fc9] group-hover:w-full transition-all duration-300"></span>
                    </span>
                </a>
                
                {% if user.is_student %}
                <a href="{% url 'enrollments:my_enrollments' %}" class="text-neutral-650 hover:text-[#1e6fc9] font-semibold text-sm transition-all relative group flex items-center">
                    <i class="fas fa-play-circle mr-1.5 text-[#99c3eb] group-hover:text-[#1e6fc9] transition-colors"></i>
                    <span class="relative">
                        My Learning
                        <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-[#1e6fc9] group-hover:w-full transition-all duration-300"></span>
                    </span>
                </a>
                {% endif %}
                
                {% if user.is_instructor %}
                <a href="{% url 'courses:course_create' %}" class="text-neutral-650 hover:text-[#1e6fc9] font-semibold text-sm transition-all relative group flex items-center">
                    <i class="fas fa-plus-circle mr-1.5 text-[#99c3eb] group-hover:text-[#1e6fc9] transition-colors"></i>
                    <span class="relative">
                        Create
                        <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-[#1e6fc9] group-hover:w-full transition-all duration-300"></span>
                    </span>
                </a>
                <a href="{% url 'courses:course_list' %}" class="text-neutral-650 hover:text-[#1e6fc9] font-semibold text-sm transition-all relative group flex items-center">
                    <i class="fas fa-chart-line mr-1.5 text-[#99c3eb] group-hover:text-[#1e6fc9] transition-colors"></i>
                    <span class="relative">
                        Analytics
                        <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-[#1e6fc9] group-hover:w-full transition-all duration-300"></span>
                    </span>
                </a>
                {% endif %}
                
                {% if user.is_authenticated %}
                <!-- User menu - matte blue design -->
                <div class="user-menu relative ml-2" id="userMenu">
                    <div class="relative cursor-pointer" onclick="toggleDropdown()">
                        <!-- Avatar glow effect - matte -->
                        <div class="absolute inset-0 bg-[#1e6fc9] rounded-xl opacity-40 blur-md group-hover:opacity-60 transition-opacity"></div>
                        
                        <!-- Avatar with matte blue border -->
                        <div class="relative w-11 h-11 bg-[#1e6fc9] rounded-xl flex items-center justify-center text-white font-bold text-lg border-2 border-white/50 shadow-lg group-hover:scale-105 group-hover:shadow-xl transition-all duration-300">
                            {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                            
                            <!-- Online status indicator - matte -->
                            <span class="absolute -top-1 -right-1 w-3.5 h-3.5">
                                <span class="absolute inset-0 bg-[#34a853] rounded-full animate-ping opacity-50"></span>
                                <span class="relative block w-3.5 h-3.5 bg-[#34a853] rounded-full border-2 border-white"></span>
                            </span>
                        </div>
                    </div>
                    
                    <!-- Dropdown menu - enhanced -->
                    <div class="dropdown absolute right-0 mt-3 w-72 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/40 overflow-hidden opacity-0 invisible translate-y-0 transition-all duration-300 z-50" id="userDropdown">
                        <!-- Header with matte blue -->
                        <div class="p-5 bg-[#e6f0fa] border-b border-[#cce1f5]">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 bg-[#1e6fc9] rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg">
                                    {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                                </div>
                                <div>
                                    <h4 class="font-bold text-neutral-850">{{ user.get_full_name }}</h4>
                                    <p class="text-xs text-[#1e6fc9]/80 truncate max-w-[180px]">{{ user.email }}</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Menu items with matte colors -->
                        <a href="{% url 'accounts:profile' %}" class="flex items-center gap-3 px-5 py-3.5 text-neutral-700 hover:bg-[#e6f0fa] transition-colors border-l-4 border-transparent hover:border-[#1e6fc9] group">
                            <i class="fas fa-user w-5 text-[#1e6fc9] group-hover:scale-110 transition-transform"></i>
                            <span class="font-medium">Your Profile</span>
                            <i class="fas fa-chevron-right ml-auto text-xs text-neutral-400 group-hover:text-[#1e6fc9] group-hover:translate-x-1 transition-all"></i>
                        </a>
                        
                        <a href="{% url 'accounts:dashboard' %}" class="flex items-center gap-3 px-5 py-3.5 text-neutral-700 hover:bg-[#e6f0fa] transition-colors border-l-4 border-transparent hover:border-[#1e6fc9] group">
                            <i class="fas fa-chart-pie w-5 text-[#1e6fc9] group-hover:scale-110 transition-transform"></i>
                            <span class="font-medium">Dashboard</span>
                            <i class="fas fa-chevron-right ml-auto text-xs text-neutral-400 group-hover:text-[#1e6fc9] group-hover:translate-x-1 transition-all"></i>
                        </a>
                        
                        {% if user.is_staff %}
                        <a href="/admin/" class="flex items-center gap-3 px-5 py-3.5 text-neutral-700 hover:bg-[#e6f0fa] transition-colors border-l-4 border-transparent hover:border-[#1e6fc9] group">
                            <i class="fas fa-shield-alt w-5 text-[#1e6fc9] group-hover:scale-110 transition-transform"></i>
                            <span class="font-medium">Admin Panel</span>
                            <i class="fas fa-chevron-right ml-auto text-xs text-neutral-400 group-hover:text-[#1e6fc9] group-hover:translate-x-1 transition-all"></i>
                        </a>
                        {% endif %}
                        
                        <div class="h-px bg-neutral-350 my-1"></div>
                        
                        <a href="{% url 'accounts:logout' %}" class="flex items-center gap-3 px-5 py-3.5 text-neutral-700 hover:bg-[#fee2e2] transition-colors border-l-4 border-transparent hover:border-[#ef4444] group">
                            <i class="fas fa-sign-out-alt w-5 text-[#ef4444] group-hover:scale-110 transition-transform"></i>
                            <span class="font-medium">Sign Out</span>
                            <i class="fas fa-chevron-right ml-auto text-xs text-neutral-400 group-hover:text-[#ef4444] group-hover:translate-x-1 transition-all"></i>
                        </a>
                    </div>
                </div>
                {% else %}
                <a href="{% url 'accounts:login' %}" class="text-neutral-650 hover:text-[#1e6fc9] font-semibold text-sm transition-all">Login</a>
                <a href="{% url 'accounts:register' %}" class="bg-[#1e6fc9] hover:bg-[#1859a1] text-white px-6 py-2.5 rounded-full font-semibold shadow-lg hover:shadow-xl hover:scale-105 hover:-translate-y-0.5 transition-all ml-2 flex items-center gap-2">
                    <i class="fas fa-rocket text-xs"></i>
                    <span>Get Started</span>
                </a>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Messages (unchanged functionally) -->
    {% if messages %}
    <div class="fixed top-24 right-6 z-[100] space-y-2 max-w-sm w-full">
        {% for message in messages %}
        <div class="bg-white/80 backdrop-blur-md rounded-xl p-4 shadow-xl border-l-4 {% if message.tags == 'success' %}border-[#34a853]{% elif message.tags == 'error' %}border-[#ef4444]{% else %}border-[#1e6fc9]{% endif %} flex items-start gap-3 animate-[slideIn_0.3s_ease]"
             style="box-shadow: 0 12px 30px -10px rgba(0,0,0,0.2);">
            <i class="fas fa-{% if message.tags == 'success' %}check-circle text-[#34a853]{% elif message.tags == 'error' %}exclamation-circle text-[#ef4444]{% else %}info-circle text-[#1e6fc9]{% endif %} text-xl mt-0.5"></i>
            <span class="text-neutral-800 font-medium flex-1">{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main container -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% block content %}{% endblock %}
    </div>

    <!-- Footer with updated matte colors -->
    <footer class="bg-white/70 backdrop-blur-sm border-t border-white/40 mt-16 py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center text-neutral-600 gap-4">
            <div class="flex items-center gap-6 text-sm">
                <span>Â© {% now "Y" %} EduFlow. All rights reserved.</span>
                <a href="#" class="hover:text-[#1e6fc9] transition flex items-center gap-1">
                    <i class="fas fa-lock text-xs"></i> Privacy
                </a>
                <a href="#" class="hover:text-[#1e6fc9] transition">Terms</a>
                <a href="#" class="hover:text-[#1e6fc9] transition flex items-center gap-1">
                    <i class="fas fa-question-circle text-xs"></i> Help
                </a>
            </div>
            <div class="flex gap-4 text-lg">
                <a href="#" class="hover:text-[#1e6fc9] transition hover:scale-110 hover:-translate-y-1 transform duration-200"><i class="fab fa-twitter"></i></a>
                <a href="#" class="hover:text-[#1e6fc9] transition hover:scale-110 hover:-translate-y-1 transform duration-200"><i class="fab fa-linkedin"></i></a>
                <a href="#" class="hover:text-[#1e6fc9] transition hover:scale-110 hover:-translate-y-1 transform duration-200"><i class="fab fa-github"></i></a>
            </div>
        </div>
    </footer>

    <!-- JavaScript (unchanged functionality) -->
    <script>
        function toggleDropdown() {
            document.getElementById('userDropdown').classList.toggle('show');
        }

        window.onclick = function(event) {
            if (!event.target.matches('.cursor-pointer') && !event.target.closest('.cursor-pointer') && !event.target.closest('.user-menu')) {
                var dropdowns = document.getElementsByClassName('dropdown');
                for (var i = 0; i < dropdowns.length; i++) {
                    if (dropdowns[i].classList.contains('show')) {
                        dropdowns[i].classList.remove('show');
                    }
                }
            }
        }

        // auto dismiss messages after 5s
        setTimeout(function() {
            var messages = document.querySelectorAll('.fixed.top-24.right-6 > div');
            messages.forEach(function(message) {
                message.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(function() {
                    message.remove();
                }, 300);
            });
        }, 5000);

        // re-add slideOut keyframe if missing (already in style)
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { opacity:0; transform:translateX(20px); }
                to { opacity:1; transform:translateX(0); }
            }
            @keyframes slideOut {
                from { opacity:1; transform:translateX(0); }
                to { opacity:0; transform:translateX(100%); }
            }
            .dropdown.show {
                opacity: 1 !important;
                visibility: visible !important;
                transform: translateY(0) !important;
            }
            .dropdown {
                transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            }
        `;
        document.head.appendChild(style);
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>